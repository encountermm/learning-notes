# 高级类型

## 交叉类型（Intersection Types）

交叉类型是将多个类型合并为一个类型。这让我们可以把现有的多种类型叠加到一起成为一种类型，它包含了所需的所有类型的特性。例如：`Person & Serializable & Loggable`同时是 `Person` 和 `Serializable` 和 `Loggable`。就是说这个类型的对象同时拥有了这三种类型的成员。

我们大多是在混入（mixins）或其它不适合典型面向对象模型的地方看到交叉类型的使用。 （在 JavaScript 里发生这种情况的场合很多！） 下面是如何创建混入的一个简单例子：

```typescript
function extend<T, U>(first: T, second: U): T & U {
	let result = <T & U>{}
	for (let id in first) {
		;(<any>result)[id] = (<any>first)[id]
	}
	for (let id in second) {
		if (!result.hasOwnProperty(id)) {
			;(<any>result)[id] = (<any>second)[id]
		}
	}
	return result
}

class Person {
	constructor(public name: string) {}
}
interface Loggable {
	log(): void
}
class ConsoleLogger implements Loggable {
	log() {
		// ...
	}
}
var jim = extend(new Person('Jim'), new ConsoleLogger())
var n = jim.name
jim.log()
```

## 联合类型（Union Types）

联合类型与交叉类型很有关联，但是使用上却完全不同。 偶尔你会遇到这种情况，一个代码库希望传入 `number` 或 `string` 类型的参数。 例如下面的函数：

```typescript
/**
 * Takes a string and adds "padding" to the left.
 * If 'padding' is a string, then 'padding' is appended to the left side.
 * If 'padding' is a number, then that number of spaces is added to the left side.
 */
function padLeft(value: string, padding: any) {
	if (typeof padding === 'number') {
		return Array(padding + 1).join(' ') + value
	}
	if (typeof padding === 'string') {
		return padding + value
	}
	throw new Error(`Expected string or number, got '${padding}'.`)
}

padLeft('Hello world', 4) // returns "    Hello world"
```

`padLeft` 存在一个问题， `padding` 参数的类型指定成了 `any`。 这就是说我们可以传入一个既不是 `number` 也不是 `string` 类型的参数，但是 TypeScript 却不报错。

```typescript
let indentedString = padLeft('Hello world', true) // 编译阶段通过，运行时报错
```

在传统的面向对象语言里，我们可能会将这两种类型抽象成有层级的类。这么做显然是非常清晰的，但同时也存在了过度设计。`padLeft` 原始版本的好处之一是允许我们传入原始类型。 这样做的话使用起来既简单又方便。 如果我们就是想使用已经存在的函数的话，这种新的方式就不适用了。

代替 `any`， 我们可以使用 联合类型做为 `padding` 的参数：

```typescript
function padLeft(value: string, padding: string | number) {
	// ...
}

let indentedString = padLeft('Hello world', true)
```

联合类型表示一个值可以是几种类型之一。 我们用竖线（`|`）分隔每个类型，所以 `number | string | boolean` 表示一个值可以是 `number， string，或 boolean`。

如果一个值是联合类型，我们只能访问此联合类型的所有类型里共有的成员。

```typescript
interface Bird {
	fly()
	layEggs()
}

interface Fish {
	swim()
	layEggs()
}

function getSmallPet(): Fish | Bird {
	// ...
}

let pet = getSmallPet()
pet.layEggs() // okay
pet.swim() // errors
```
